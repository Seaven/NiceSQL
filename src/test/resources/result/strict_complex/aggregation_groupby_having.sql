SELECT col1,COUNT(*),SUM(col2) FROM ( VALUES (1,10),(2,20),(1,30)) AS t([768 546 486 475 379 357 290 237 226 221 197 190],[770 546 486 475 379 357 290 237 226 221 197 190]) GROUP BY col1 HAVING SUM(col2) > 20;